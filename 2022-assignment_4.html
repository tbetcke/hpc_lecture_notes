
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Assignment 4 - Solving a finite element system &#8212; Techniques of High-Performance Computing - Lecture Notes</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Class 1 (Monday 10 October)" href="2022-class_1.html" />
    <link rel="prev" title="Assignment 3 - Sparse matrices" href="2022-assignment_3.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/cpu_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Techniques of High-Performance Computing - Lecture Notes</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to Techniques of High-Performance Computing
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  High-Performance Computing with Python
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="what_is_hpc.html">
   What is High-Performance Computing?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hpc_languages.html">
   Languages for High-Performance Computing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="python_hpc_tools.html">
   Python HPC Tools
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="numpy_and_data_layouts.html">
   Memory layout and Numpy arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="parallel_principles.html">
   Parallel Computing Principles in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="working_with_numba.html">
   Working with Numba
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simd.html">
   SIMD Autovectorization in Numba
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="numexpr.html">
   A Numexpr example
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="gpu_introduction.html">
   An Introduction to GPU Computing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cuda_introduction.html">
   A tour of CUDA
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="numba_cuda.html">
   Numba Cuda in Practice
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rbf_evaluation.html">
   GPU accelerated evaluation of particle sums
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Sparse Linear Algebra
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="sparse_linalg_pde.html">
   The need for sparse linear algebra - A PDE example
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sparse_data_structures.html">
   Sparse Matrix data structures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sparse_solvers_introduction.html">
   An introduction to sparse linear system solvers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="it_solvers1.html">
   Iterative Solvers 1 - Krylov subspaces, Arnoldi Iteration and the Full Orthogonalisation Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="it_solvers2.html">
   Iterative Solvers 2 - From FOM to GMRES
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="it_solvers3.html">
   Iterative Solvers 3 - The Conjugate Gradient Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="it_solvers4.html">
   Iterative Solvers 4 - Preconditioning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sparse_direct_solvers.html">
   Sparse Direct Solvers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="petsc_for_sparse_systems.html">
   Using petsc4py for sparse linear systems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multigrid.html">
   Multigrid Methods
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Time-Dependent Problems
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="simple_time_stepping.html">
   Simple time-stepping
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wave_equation.html">
   Discretising the wave equation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Conclusions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="further_topics.html">
   Further topics
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Assignments
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="2022-assignment_1.html">
   Assignment 1 - Matrix-matrix multiplication
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-assignment_2.html">
   Assignment 2 - Solving two 1D problems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-assignment_3.html">
   Assignment 3 - Sparse matrices
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Assignment 4 - Solving a finite element system
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tasks for Monday Practical Classes
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="2022-class_1.html">
   Class 1 (Monday 10 October)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-class_2.html">
   Class 2 (Monday 17 October)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-class_3.html">
   Class 3 (Monday 24 October)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-class_4.html">
   Class 4 (Monday 31 October)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-class_5.html">
   Class 5 (Monday 14 November)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-class_6.html">
   Class 6 (Monday 21 November)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-class_7.html">
   Class 7 (Monday 5 December)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Additional notes from 2022
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="2022_matrices_and_simultaneous_equations.html">
   Matrices and simultaneous equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022_classes.html">
   Python classes
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/2022-assignment_4.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-assignment">
   The assignment
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mathematical-background">
     Mathematical background
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#part-1-creating-the-matrix-and-vector">
     Part 1: creating the matrix and vector
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#part-2-solving-the-system">
     Part 2: solving the system
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#part-3-comparing-solvers-and-preconditioners">
     Part 3: comparing solvers and preconditioners
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#part-4-increasing-n">
     Part 4: increasing
     <span class="math notranslate nohighlight">
      \(N\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#part-5-parallelisation">
     Part 5: parallelisation
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Assignment 4 - Solving a finite element system</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-assignment">
   The assignment
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mathematical-background">
     Mathematical background
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#part-1-creating-the-matrix-and-vector">
     Part 1: creating the matrix and vector
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#part-2-solving-the-system">
     Part 2: solving the system
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#part-3-comparing-solvers-and-preconditioners">
     Part 3: comparing solvers and preconditioners
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#part-4-increasing-n">
     Part 4: increasing
     <span class="math notranslate nohighlight">
      \(N\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#part-5-parallelisation">
     Part 5: parallelisation
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="assignment-4-solving-a-finite-element-system">
<h1>Assignment 4 - Solving a finite element system<a class="headerlink" href="#assignment-4-solving-a-finite-element-system" title="Permalink to this headline">#</a></h1>
<p>This assignment makes up 30% of the overall marks for the course. The deadline for submitting this assignment is <strong>5pm on Thursday 15 December 2022</strong>.</p>
<p>Coursework is to be submitted using the link on Moodle. You should submit a single pdf file containing your code, the output when you run your code, and your answers
to any text questions included in the assessment. The easiest ways to create this file are:</p>
<ul class="simple">
<li><p>Write your code and answers in a Jupyter notebook, then select File -&gt; Download as -&gt; PDF via LaTeX (.pdf).</p></li>
<li><p>Write your code and answers on Google Colab, then select File -&gt; Print, and print it as a pdf.</p></li>
</ul>
<p>Tasks you are required to carry out and questions you are required to answer are shown in bold below.</p>
<section id="the-assignment">
<h2>The assignment<a class="headerlink" href="#the-assignment" title="Permalink to this headline">#</a></h2>
<section id="mathematical-background">
<h3>Mathematical background<a class="headerlink" href="#mathematical-background" title="Permalink to this headline">#</a></h3>
<p>In this assignment, we are going to solve a Helmholtz wave problem:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
-\Delta u - k^2u &amp;= 0&amp;\text{in }\Omega,\\
u &amp;= g&amp;\text{on the boundary of }\Omega.
\end{align*}\end{split}\]</div>
<p>As our domain we will use the unit square, ie <span class="math notranslate nohighlight">\(\Omega=[0,1]^2\)</span>.
In this assignment, we will use <span class="math notranslate nohighlight">\(k=5\)</span> and</p>
<div class="math notranslate nohighlight">
\[\begin{split}
g(x,y)=
\begin{cases}
\sin(4y)&amp;\text{if }x=0,\\
\sin(3x)&amp;\text{if }y=0,\\
\sin(3+4y)&amp;\text{if }x=1,\\
\sin(3x+4)&amp;\text{if }y=1.
\end{cases}
\end{split}\]</div>
<p>The finite element method is a method that can approximately solve problems like this. We first split the square <span class="math notranslate nohighlight">\([0,1]^2\)</span> into a mesh of <span class="math notranslate nohighlight">\(N\)</span> squares by <span class="math notranslate nohighlight">\(N\)</span> squares
(or <span class="math notranslate nohighlight">\(N+1\)</span> points by <span class="math notranslate nohighlight">\(N+1\)</span> points -
note that there are <span class="math notranslate nohighlight">\(N\)</span> squares along each side, but <span class="math notranslate nohighlight">\(N+1\)</span> points along each side (watch out for off-by-one errors)):</p>
<p><img alt="A mesh of  squares by  squares" src="_images/2022a4-mesh.png" /></p>
<p>As shown in the diagram, we let <span class="math notranslate nohighlight">\(h=1/N\)</span>.</p>
<p>The (degree 1) finite element method looks for an approximate solution by placing an unknown value/variable at each point, and approximating the solution as some
linear combination of the functions <span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(xy\)</span> inside each square. Re-writing the problem as an integral equation (and doing a bit of algebra) allows
us to turn the problem into the matrix vector problem</p>
<div class="math notranslate nohighlight">
\[\mathrm{A}\mathbf{x}=\mathbf{b}.\]</div>
<p>(We do not need to go into details of how this method is derived, but if you’re curious, the first chapter of
<em>Numerical Solution of Partial Differential Equations by the Finite Element Method</em> by Claes Johnson
gives a good introduction to this method.)</p>
<p>Let <span class="math notranslate nohighlight">\(\mathbf{p}_0\)</span>, <span class="math notranslate nohighlight">\(\mathbf{p}_1\)</span>, …, <span class="math notranslate nohighlight">\(\mathbf{p}_{(N-1)^2-1}\)</span> be the points in our mesh that are not on the boundary (in some order). Let <span class="math notranslate nohighlight">\(x_0\)</span>, <span class="math notranslate nohighlight">\(x_1\)</span>, …, <span class="math notranslate nohighlight">\(x_{(N-1)^2-1}\)</span> be
the values/variables at the points (these are the entries of the unknown vector <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>).</p>
<p><span class="math notranslate nohighlight">\(\mathrm{A}\)</span> is an <span class="math notranslate nohighlight">\((N-1)^2\)</span> by <span class="math notranslate nohighlight">\((N-1)^2\)</span> matrix. <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> is a vector with <span class="math notranslate nohighlight">\((N-1)^2\)</span> entries. The entries <span class="math notranslate nohighlight">\(a_{i,j}\)</span> and <span class="math notranslate nohighlight">\(b_j\)</span> of the matrix <span class="math notranslate nohighlight">\(\mathrm{A}\)</span> and vector <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> are given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
a_{i,j} &amp;=\begin{cases}
\displaystyle
\frac{24-4h^2k^2}{9}&amp;\text{if }i=j\\
\displaystyle
\frac{-3-h^2k^2}{9}
&amp;\text{if }\mathbf{p}_i\text{ and }\mathbf{p}_j\text{ are horizontally or vertically adjacent}\\
\displaystyle
\frac{-12-h^2k^2}{36}
&amp;\text{if }\mathbf{p}_i\text{ and }\mathbf{p}_j\text{ are diagonally adjacent}\\
0&amp;\text{otherwise}
\end{cases}\\[1cm]
b_{j} &amp;=\begin{cases}
\displaystyle
\frac{12+h^2k^2}{36} g(0,0)+\frac{3+h^2k^2}{9}\left(g(h,0)+g(0, h)\right)
&amp;\text{if }\mathbf{p}_j=(h,h)\\
\displaystyle
\frac{12+h^2k^2}{36} g(1,0)+\frac{3+h^2k^2}{9}\left(g(1-h,0)+g(1, h)\right)
&amp;\text{if }\mathbf{p}_j=(1-h,h)\\
\displaystyle
\frac{12+h^2k^2}{36} g(0,1)+\frac{3+h^2k^2}{9}\left(g(h,1)+g(0, 1-h)\right)
&amp;\text{if }\mathbf{p}_j=(h,1-h)\\
\displaystyle
\frac{12+h^2k^2}{36} g(1,1)+\frac{3+h^2k^2}{9}\left(g(1-h,1)+g(1, 1-h)\right)
&amp;\text{if }\mathbf{p}_j=(1-h,1-h)\\
\\[3mm]
\displaystyle
\frac{3+h^2k^2}{9} g(0,c_j)
&amp;\text{if }\mathbf{p}_j=(h,c_j)\text{, with }c_j\not=h\text{ and }c_j\not=1-h\\
\displaystyle
\frac{3+h^2k^2}{9} g(1,c_j)
&amp;\text{if }\mathbf{p}_j=(1-h,c_j)\text{, with }c_j\not=h\text{ and }c_j\not=1-h\\
\displaystyle
\frac{3+h^2k^2}{9} g(c_j,0)
&amp;\text{if }\mathbf{p}_j=(c_j,h)\text{, with }c_j\not=h\text{ and }c_j\not=1-h\\
\displaystyle
\frac{3+h^2k^2}{9} g(c_j,1)
&amp;\text{if }\mathbf{p}_j=(c_j,1-h)\text{, with }c_j\not=h\text{ and }c_j\not=1-h
\\[3mm]
0&amp;\text{otherwise}
\end{cases}
\end{align*}\end{split}\]</div>
<p>For example (using <span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(g\)</span> as given above) when <span class="math notranslate nohighlight">\(N=2\)</span>,</p>
<div class="math notranslate nohighlight">
\[
\mathrm{A}=\begin{pmatrix}
-0.11111111
\end{pmatrix}.
\]</div>
<p>For <span class="math notranslate nohighlight">\(N=2\)</span>, the definition of <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> is different to above, as the point at <span class="math notranslate nohighlight">\((1/2,1/2)\)</span> is adjecent to all three sides.</p>
<p>As as second example, when <span class="math notranslate nohighlight">\(N=3\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathrm{A}=\begin{pmatrix}
 1.43209877&amp; -0.64197531&amp; -0.64197531&amp; -0.41049383\\
-0.64197531&amp;  1.43209877&amp; -0.41049383&amp; -0.64197531\\
-0.64197531&amp; -0.41049383&amp;  1.43209877&amp; -0.64197531\\
-0.41049383&amp; -0.64197531&amp; -0.64197531&amp;  1.43209877
\end{pmatrix},
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathrm{b}=\begin{pmatrix}
1.85116856\\0.35362119\\-0.11199319\\-0.72940276
\end{pmatrix}.
\end{split}\]</div>
<p>In this second example, I have numbered the points like this:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{cc}
2&amp;3\\
0&amp;1
\end{array}
\end{split}\]</div>
</section>
<section id="part-1-creating-the-matrix-and-vector">
<h3>Part 1: creating the matrix and vector<a class="headerlink" href="#part-1-creating-the-matrix-and-vector" title="Permalink to this headline">#</a></h3>
<p><strong>Write a function that takes <span class="math notranslate nohighlight">\(N\)</span> as an input and returns the matrix <span class="math notranslate nohighlight">\(\mathrm{A}\)</span> and the vector <span class="math notranslate nohighlight">\(\mathbf{b}\)</span></strong>. The matrix should be stored using an appropriate sparse format - you may use Scipy for this, and do not need to implement your own format.</p>
<p>You can find <a class="reference internal" href="2022-a4-A_and_b.html"><span class="doc std std-doc">example matrices and vectors for <span class="math notranslate nohighlight">\(N=2\)</span>, <span class="math notranslate nohighlight">\(N=3\)</span>, and <span class="math notranslate nohighlight">\(N=4\)</span> here</span></a>. You may wish to use them to validate your function, but you do not need to include this validation as
part of the assignment.</p>
</section>
<section id="part-2-solving-the-system">
<h3>Part 2: solving the system<a class="headerlink" href="#part-2-solving-the-system" title="Permalink to this headline">#</a></h3>
<p>Solving the matrix-vector problem will lead to an approximate solution to the Helmholtz problem:
we call this approximate solution <span class="math notranslate nohighlight">\(u_h\)</span>.</p>
<p>Using any matrix-vector solver, <strong>solve the matrix-vector problem for <span class="math notranslate nohighlight">\(N=4\)</span>, <span class="math notranslate nohighlight">\(N=8\)</span>, and <span class="math notranslate nohighlight">\(N=16\)</span></strong> and <strong>plot the approximate solutions
to the Helmholtz problem</strong>. To plot
the solutions, you can pass the <span class="math notranslate nohighlight">\(x\)</span>- and <span class="math notranslate nohighlight">\(y\)</span>-coordinates of the points and the value of <span class="math notranslate nohighlight">\(u_h\)</span> at each
point into matplotlib’s 3D plotting function. For the points on the boundary, the value of <span class="math notranslate nohighlight">\(u_h\)</span> is
given by the function <span class="math notranslate nohighlight">\(g\)</span>; for interior points, the value will be one of the entries of the solution
vector <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>.</p>
<p>An example of 3D plotting in matplotlib can be found in the <a class="reference internal" href="sparse_linalg_pde.html"><span class="doc std std-doc">sparse PDE example</span></a> from earlier in the course.</p>
</section>
<section id="part-3-comparing-solvers-and-preconditioners">
<h3>Part 3: comparing solvers and preconditioners<a class="headerlink" href="#part-3-comparing-solvers-and-preconditioners" title="Permalink to this headline">#</a></h3>
<p>In this section, your task is to evaluate the performance of various matrix-vector solvers.
To do this, <strong>solve the matrix-vector problem with small to medium sized value of <span class="math notranslate nohighlight">\(N\)</span> using a range of different solvers of your choice,
measuring factors you deem to be important for your evaluation.</strong> These factors should include
the time taken by the solver, and may additionally include many other thing such as the number of
iterations taken by an iterative solver, or the size of the residual after each iteration.
<strong>Make a set of plots that show the measurements you have made and allow you to compare the solvers</strong>.</p>
<p>You should compare at least five matrix-vector solvers: at least two of these should be iterative
solvers, and at least one should be a direct solver. You should use some solvers from the Scipy
library and some from PETSc. (You may optionally use additional solvers from other linear algebra
libraries, but you do not need to do this to achieve high marks. You should use solvers from these libraries and do not need to implement your own solvers.)
For two of the iterative solvers you have chosen to use,
<strong>repeat the comparisons with three different choices of preconditioner</strong>.</p>
<p>Based on your experiments, <strong>pick a solver</strong> (and a preconditioner if it improves the solver)
that you think is most appropriate to solve this matrix-vector problem. <strong>Explain, making use
of the data from your experiments, why this is the best solver for this problem</strong>.</p>
</section>
<section id="part-4-increasing-n">
<h3>Part 4: increasing <span class="math notranslate nohighlight">\(N\)</span><a class="headerlink" href="#part-4-increasing-n" title="Permalink to this headline">#</a></h3>
<p>In this section, you are going to use the solver you picked in part 3 to compute the solution
for larger values of <span class="math notranslate nohighlight">\(N\)</span>.</p>
<p>The problem we have been solving in this assignment has the exact solution <span class="math notranslate nohighlight">\(u_\text{exact}=\sin(3x+4y)\)</span>.
A measure of the error of an approximate solution <span class="math notranslate nohighlight">\(u_h\)</span> can be computed using</p>
<div class="math notranslate nohighlight">
\[
\sum_{i=0}^{N-1} h^2\left|u_\text{exact}(\mathbf{m}_i)-u_h(\mathbf{m}_i)\right|,
\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{m}_i\)</span> is the midpoint of the <span class="math notranslate nohighlight">\(i\)</span>th square in the finite element mesh: the value of
<span class="math notranslate nohighlight">\(u_h\)</span> at this midpoint will be the mean of the values at the four corners of the square.</p>
<p>For a range of values of <span class="math notranslate nohighlight">\(N\)</span> from small to large, <strong>compute the solution to the matrix-vector
problem</strong>. <strong>Measure the time taken to compute this solution</strong>, and <strong>compute the error of the solution</strong>.
<strong>Make plots showing the time taken and error as <span class="math notranslate nohighlight">\(N\)</span> is increased</strong>.</p>
<p>Using your plots, <strong>estimate the complexity of the solver you are using</strong> (ie is it <span class="math notranslate nohighlight">\(\mathcal{O}(N)\)</span>?
Is it <span class="math notranslate nohighlight">\(\mathcal{O}(N^2)\)</span>?), and <strong>estimate the order of convergence of your solution</strong> (your error
should decrease like <span class="math notranslate nohighlight">\(\mathcal{O}(N^{-\alpha})\)</span> for some <span class="math notranslate nohighlight">\(\alpha&gt;0\)</span>). Briefly (1-2 sentences)
<strong>comment on how you have made these estimates of the complexity and order.</strong></p>
</section>
<section id="part-5-parallelisation">
<h3>Part 5: parallelisation<a class="headerlink" href="#part-5-parallelisation" title="Permalink to this headline">#</a></h3>
<p>In this section, we will consider how your solution method could be parallelised; you do not need,
however, to implement a parallel version of your solution method.</p>
<p><strong>Comment on how your solution method could be parallelised.</strong> Which parts (if any) would be trivial
to parallelise? Which parts (if any) would be difficult to parallelise? By how much would you expect
parallelisation to speed up your solution method?</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="2022-assignment_3.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Assignment 3 - Sparse matrices</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="2022-class_1.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Class 1 (Monday 10 October)</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Timo Betcke & Matthew Scroggs<br/>
  
      &copy; Copyright 2020-22.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>